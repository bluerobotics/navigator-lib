<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="The `gpio-cdev` crate provides access to the GPIO character device ABI.  This API, stabilized with Linux v4.4, deprecates the legacy sysfs interface to GPIOs that is planned to be removed from the upstream kernel after year 2020 (which is coming up quickly)."><title>gpio_cdev - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-f3501f0f5ae15dfb.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="gpio_cdev" data-themes="" data-resource-suffix="" data-rustdoc-version="1.71.0-nightly (cba14074b 2023-05-10)" data-search-js="search-4926e5fc22a5646a.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-6f6ffb5395b17c6e.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../static.files/storage-62ce34ea385b278a.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-f0540c1d82cde29b.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../gpio_cdev/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../gpio_cdev/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate gpio_cdev</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.5.1</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">gpio_cdev</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/gpio_cdev/lib.rs.html#9-1025">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>The <code>gpio-cdev</code> crate provides access to the <a href="https://www.kernel.org/doc/Documentation/ABI/testing/gpio-cdev">GPIO character device
ABI</a>.  This API,
stabilized with Linux v4.4, deprecates the legacy sysfs interface to GPIOs that is
planned to be removed from the upstream kernel after
year 2020 (which is coming up quickly).</p>
<p>This crate attempts to wrap this interface in a moderately direction fashion
while retaining safety and using Rust idioms (where doing so could be mapped
to the underlying abstraction without significant overhead or loss of
functionality).</p>
<p>For additional context for why the kernel is moving from the sysfs API to the
character device API, please see the main <a href="https://github.com/rust-embedded/rust-gpio-cdev">README on Github</a>.</p>
<h2 id="examples"><a href="#examples">Examples</a></h2>
<p>The following example reads the state of a GPIO line/pin and writes the matching
state to another line/pin.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>gpio_cdev::{Chip, LineRequestFlags, EventRequestFlags, EventType};

<span class="comment">// Lines are offset within gpiochip0; see docs for more info on chips/lines
</span><span class="kw">fn </span>mirror_gpio(inputline: u32, outputline: u32) -&gt; <span class="prelude-ty">Result</span>&lt;(), gpio_cdev::Error&gt; {
    <span class="kw">let </span><span class="kw-2">mut </span>chip = Chip::new(<span class="string">&quot;/dev/gpiochip0&quot;</span>)<span class="question-mark">?</span>;
    <span class="kw">let </span>input = chip.get_line(inputline)<span class="question-mark">?</span>;
    <span class="kw">let </span>output = chip.get_line(outputline)<span class="question-mark">?</span>;
    <span class="kw">let </span>output_handle = output.request(LineRequestFlags::OUTPUT, <span class="number">0</span>, <span class="string">&quot;mirror-gpio&quot;</span>)<span class="question-mark">?</span>;
    <span class="kw">for </span>event <span class="kw">in </span>input.events(
        LineRequestFlags::INPUT,
        EventRequestFlags::BOTH_EDGES,
        <span class="string">&quot;mirror-gpio&quot;</span>,
    )<span class="question-mark">? </span>{
        <span class="kw">let </span>evt = event<span class="question-mark">?</span>;
        <span class="macro">println!</span>(<span class="string">&quot;{:?}&quot;</span>, evt);
        <span class="kw">match </span>evt.event_type() {
            EventType::RisingEdge =&gt; {
                output_handle.set_value(<span class="number">1</span>)<span class="question-mark">?</span>;
            }
            EventType::FallingEdge =&gt; {
                output_handle.set_value(<span class="number">0</span>)<span class="question-mark">?</span>;
            }
        }
    }

    <span class="prelude-val">Ok</span>(())
}
</code></pre></div>
<p>To get the state of a GPIO Line on a given chip:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>gpio_cdev::{Chip, LineRequestFlags};

<span class="comment">// Read the state of GPIO4 on a raspberry pi.  /dev/gpiochip0
// maps to the driver for the SoC (builtin) GPIO controller.
// The LineHandle returned by request must be assigned to a
// variable (in this case the variable handle) to ensure that
// the corresponding file descriptor is not closed.
</span><span class="kw">let </span><span class="kw-2">mut </span>chip = Chip::new(<span class="string">&quot;/dev/gpiochip0&quot;</span>)<span class="question-mark">?</span>;
<span class="kw">let </span>handle = chip
    .get_line(<span class="number">4</span>)<span class="question-mark">?
    </span>.request(LineRequestFlags::INPUT, <span class="number">0</span>, <span class="string">&quot;read-input&quot;</span>)<span class="question-mark">?</span>;
<span class="kw">for _ in </span><span class="number">1</span>..<span class="number">4 </span>{
    <span class="macro">println!</span>(<span class="string">&quot;Value: {:?}&quot;</span>, handle.get_value()<span class="question-mark">?</span>);
}</code></pre></div>
</div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2><ul class="item-table"><li><div class="item-name"><code>pub use <a class="mod" href="errors/index.html" title="mod gpio_cdev::errors">errors</a>::*;</code></div></li></ul><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="errors/index.html" title="mod gpio_cdev::errors">errors</a></div><div class="desc docblock-short">This module is deprecated and types are exported from the top-level of the crate</div></li></ul><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Chip.html" title="struct gpio_cdev::Chip">Chip</a></div><div class="desc docblock-short">A GPIO Chip maps to the actual device driver instance in hardware that
one interacts with to interact with individual GPIOs.  Often these chips
map to IP chunks on an SoC but could also be enumerated within the kernel
via something like a PCI or USB bus.</div></li><li><div class="item-name"><a class="struct" href="struct.ChipIterator.html" title="struct gpio_cdev::ChipIterator">ChipIterator</a></div><div class="desc docblock-short">Iterator over chips</div></li><li><div class="item-name"><a class="struct" href="struct.EventRequestFlags.html" title="struct gpio_cdev::EventRequestFlags">EventRequestFlags</a></div><div class="desc docblock-short">Event request flags</div></li><li><div class="item-name"><a class="struct" href="struct.Line.html" title="struct gpio_cdev::Line">Line</a></div><div class="desc docblock-short">Access to a specific GPIO Line</div></li><li><div class="item-name"><a class="struct" href="struct.LineEvent.html" title="struct gpio_cdev::LineEvent">LineEvent</a></div><div class="desc docblock-short">Information about a change to the state of a Line</div></li><li><div class="item-name"><a class="struct" href="struct.LineEventHandle.html" title="struct gpio_cdev::LineEventHandle">LineEventHandle</a></div><div class="desc docblock-short">Handle for retrieving events from the kernel for a line</div></li><li><div class="item-name"><a class="struct" href="struct.LineFlags.html" title="struct gpio_cdev::LineFlags">LineFlags</a></div><div class="desc docblock-short">Informational Flags</div></li><li><div class="item-name"><a class="struct" href="struct.LineHandle.html" title="struct gpio_cdev::LineHandle">LineHandle</a></div><div class="desc docblock-short">Handle for interacting with a “requested” line</div></li><li><div class="item-name"><a class="struct" href="struct.LineInfo.html" title="struct gpio_cdev::LineInfo">LineInfo</a></div><div class="desc docblock-short">Information about a specific GPIO Line</div></li><li><div class="item-name"><a class="struct" href="struct.LineIterator.html" title="struct gpio_cdev::LineIterator">LineIterator</a></div><div class="desc docblock-short">Iterator over GPIO Lines for a given chip.</div></li><li><div class="item-name"><a class="struct" href="struct.LineRequestFlags.html" title="struct gpio_cdev::LineRequestFlags">LineRequestFlags</a></div><div class="desc docblock-short">Line Request Flags</div></li><li><div class="item-name"><a class="struct" href="struct.Lines.html" title="struct gpio_cdev::Lines">Lines</a></div><div class="desc docblock-short">A collection of lines that can be accesses simultaneously</div></li><li><div class="item-name"><a class="struct" href="struct.MultiLineHandle.html" title="struct gpio_cdev::MultiLineHandle">MultiLineHandle</a></div><div class="desc docblock-short">Handle for interacting with a “requested” line</div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.EventType.html" title="enum gpio_cdev::EventType">EventType</a></div><div class="desc docblock-short">Did the Line rise (go active) or fall (go inactive)?</div></li><li><div class="item-name"><a class="enum" href="enum.IoctlKind.html" title="enum gpio_cdev::IoctlKind">IoctlKind</a></div></li><li><div class="item-name"><a class="enum" href="enum.LineDirection.html" title="enum gpio_cdev::LineDirection">LineDirection</a></div><div class="desc docblock-short">In or Out</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.chips.html" title="fn gpio_cdev::chips">chips</a></div><div class="desc docblock-short">Iterate over all GPIO chips currently present on this system</div></li></ul></section></div></main></body></html>